<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Development &#8211; Seventeen Acres</title>
	<atom:link href="http://www.17acr.com/category/category/dev/feed" rel="self" type="application/rss+xml" />
	<link>http://www.17acr.com</link>
	<description>Random Engineering Hacks</description>
	<lastBuildDate>Tue, 01 Aug 2017 20:31:45 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.8</generator>

<image>
	<url>http://www.17acr.com/wp-content/uploads/2017/07/cropped-2017-07-31-12_18_13-CircuitMaker-1.3-Logo.CMPcbDoc-industRIO.PrjPcb-Dan-Nichols-is-signed-in.-32x32.png</url>
	<title>Development &#8211; Seventeen Acres</title>
	<link>http://www.17acr.com</link>
	<width>32</width>
	<height>32</height>
</image> 
	<item>
		<title>Battery Test</title>
		<link>http://www.17acr.com/category/dev/battery-test</link>
		<comments>http://www.17acr.com/category/dev/battery-test#comments</comments>
		<pubDate>Tue, 30 Aug 2016 16:04:36 +0000</pubDate>
		<dc:creator><![CDATA[dan]]></dc:creator>
				<category><![CDATA[Development]]></category>

		<guid isPermaLink="false">http://www.17acr.com/?p=97</guid>
		<description><![CDATA[Now that the Jaguar motor controller has reached its end of life, many teams have them sitting around in a box somewhere. FRC team 548 had around two dozen hiding in a tote. One use I found for them is testing batteries. After many brownouts during the 2016 season, we wondered if the batteries were at fault. &#8230; <a href="http://www.17acr.com/category/dev/battery-test" class="more-link">Continue reading <span class="screen-reader-text">Battery Test</span> <span class="meta-nav">&#8594;</span></a>]]></description>
				<content:encoded><![CDATA[<p>Now that the <a href="https://www.vexrobotics.com/217-3367.html">Jaguar</a> motor controller has reached its end of life, many teams have them sitting around in a box somewhere. FRC team 548 had around two dozen hiding in a tote. One use I found for them is testing batteries. After many brownouts during the 2016 season, we wondered if the batteries were at fault. My first plan was to use a robot, but we had no good way to eliminate variables from that plan, it was noisy, and motors overheated. Conveniently, 548 had a roll of steel high-temperature wire which had a total resistance of around 0.58Ω, able to burn about 14 amps at 8 volts for hours on end. <span id="more-97"></span></p>
<p>The final design was to connect the coil to a Jaguar controlled by a PC to log data while draining the battery over around one and a half hours.</p>
<h1>Disclaimer</h1>
<p>Seventeen Acres Battery Test is provided under the MPL 1.0. Use of this software is at your own risk. This software does not have adequate safety mechanisms to allow use with any moving parts. Even use with a purely reistive load is at your own risk and may cause severe damage to all devices involved or injury. Devices which consume power will get hot and may cause injury. The software may cause data loss or computer instability. Do not run this software on a mission-critical computer. USE THIS SOFTWARE AND GUIDE AT YOUR OWN RISK.</p>
<h1>Hardware</h1>
<ul>
<li>Battery clamp leads</li>
<li>cRIO-era PDP with 40A breaker</li>
<li>Black Jaguar motor controller with ??????? firmware</li>
<li>Insulated steel wire</li>
<li>Wire rack</li>
<li>6P6C RJ25 cable</li>
<li>DB9 to RJ25 RS-232 adapter with CAN terminator</li>
<li>USB to RS-232 adapter (if needed)</li>
<li>Standard box fan</li>
<li>Windows computer</li>
</ul>
<p>The input side of the Jaguar is wired similar to a normal robot (Battery to PDP to Jaguar) but the battery leads connect directly to the PDP since the sum of the output breaker current ratings (40A) is less than the standard 120A of the main breaker, making it useless. The steel wire was wrapped into three separate sections in case a different resistance was required. The ends of the resistance wires are simply connected to the output of the Jaguar. The panel of wires is then placed on top of a box fan propped up off the ground. A black Jaguar was used since it contains a RS-232 to CAN adapter inside. In theory, the software would work with an external CAN bridge to a grey/tan Jaguar, but that has not been tested. The Jaguar is connected to the computer using the same setup as for firmware updates or ID configuration. Using a 6P6C cable in the &#8216;input&#8217; port, the Jaguar connects to the RJ25 serial adapter which directly attached to the USB to serial adapter, in this case a TRENDnet TU-S9.</p>
<h1>Software</h1>
<p>The goal of the project is to discharge the batteries under constant current then graph the battery voltage during that period and calculate the amount of energy spent before a cutoff voltage. The simplest way to do this would be to use a cRIO but they are expensive and not very user friendly to get a CSV from.  While the Jaguars have RS-232 serial built in, the protocol is not well-documented or simple. The BDC-COMM software used to configure the Jaguars in Windows, however, has an often-ignored CLI mode which, although somewhat cryptic, is <a href="http://www.ti.com/lit/ug/spmu065d/spmu065d.pdf">documented </a>enough.  The CLI enables most all of the function of the Jaguar including PID, sensor data (input voltage, temperature, output current, output voltage, and more) , encoder function, and output settings. The Battery Test java application launches BDC-COMM CLI internally and redirects its input and output streams. In constant current mode, the Java application runs a PID loop on the input current to output a set voltage to the Jaguar via BDC-COMM.  The Input current is determined from output power, input voltage, and an efficency factor experimentally found of ~.94. Every 10 ms, the status values, setpoint, and the integrator which calculates energy drain are updated. Every 100ms, a snapshot of input voltage, current, power, and energy and output voltage, current, power, and energy is logged to a CSV. At 60hz, the displays inside the GUI are updated.</p>
<h1>Prerequisites</h1>
<ul>
<li>PC running Windows (tested on Windows 10)</li>
<li>Java 8 runtime (tested on Java 1.8)</li>
<li>Drivers installed for USB to serial adapter</li>
<li>??????Firmware installed on Jaguar</li>
<li>Jaguar configured as ID 1</li>
<li><a href="http://content.vexrobotics.com/downloads/217-3367-VEXpro_Jaguar_BDC-COMM-107.zip">BDC-COMM</a> extracted and <a href="https://github.com/17acres/BatteryTest/raw/master/out/artifacts/Battery_Test_jar/Battery%20Test.jar">Battery Test</a>  downloaded to the same directory</li>
</ul>
<h1>Operation</h1>
<ol>
<li>With the load connected to the output of the Jaguar, attach the leads to the battery, powering on the Jaguar.</li>
<li>Connect the USB to serial adapter to the computer</li>
<li>In Device Manager note the COM port number of the USB to serial adapter</li>
<li>If connected to a motor or other load which has a risk of danger, prepare for movement as soon as Battery Test is launched.</li>
<li>Open the Battery Test jar and enter the noted port number</li>
<li> For Constant Input Current Operation:
<ol>
<li>Set the cutoff voltage to a reasonable value (default: 10.5V)</li>
<li>Select &#8216;Constant&#8217; cycle mode</li>
<li>Set DC Offset to the desired input current. Note that this current must be less than what the load draws at the cutoff voltage. For example. with a 2Ω load and a 10V cutoff, the maximum possible current is roughly 5A. For smoother operation stay well below that threshold. Note that very low resistance loads can cause damage to the Jaguar since the software cannot respond quick enough to handle the massive current.</li>
<li></li>
</ol>
</li>
</ol>
]]></content:encoded>
			<wfw:commentRss>http://www.17acr.com/category/dev/battery-test/feed</wfw:commentRss>
		<slash:comments>3</slash:comments>
		</item>
	</channel>
</rss>
